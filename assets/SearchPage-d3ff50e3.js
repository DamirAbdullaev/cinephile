import{u as P,c as v,r as V,a as B,o,b as h,w as D,d as f,e as u,t as N,f as q,g as F,h as H,i as R,j as n,k as U,l as E,m as r,v as I,n as g,p as K,F as M,q as $,s as b,x as L}from"./index-e58a277f.js";const O={alt:""},Y={__name:"SearchContent",props:{item:Object},setup(l){const e=P(),c=v(()=>e.movieUrl),_=v(()=>e.movieSize);return e.getConfiguration(),e.getUpcoming(),(y,S)=>{const i=V("router-link"),t=B("lazy");return o(),h(i,{to:`/${l.item.media_type}/`+l.item.id,class:"main__catalog_list-item"},{default:D(()=>[f(u("img",O,null,512),[[t,c.value+_.value+l.item.poster_path]]),u("h2",null,N(l.item.title||l.item.name),1)]),_:1},8,["to"])}}},A=q({id:"Search",state:()=>({url:"https://api.themoviedb.org/3",result:null}),actions:{async getSearch(l){try{let e=await F.get(`${this.url}/search/multi?api_key=${H}&language=RU&query=${l}`);this.result=e.data.results}catch(e){console.error("Произошла ошибка при поиске фильмов или сериалов "+e)}}}}),G={class:"container"},J={class:"main__search"},Q={key:0,class:"main__search_list"},W={key:1,class:"main__catalog_list"},X={alt:""},Z={__name:"Search",setup(l){const e=R(),c=A(),_=P(),y=v(()=>_.movieUrl),S=v(()=>_.movieSize);let i=n(""),t=n("");t.value==""?i.value="movie":i.value="",e.getPopular({type:i.value}),_.getConfiguration();const k=n(1),m=n([]),w=n([]);U(t,(s,p)=>{s!==""?m.value=[]:m.value=w.value});let d=n(!1);const x=async()=>{if(!d.value){d.value=!0,await e.getPopular({type:i.value,page:k.value});let s=e.popularMovies;m.value.push(...s),w.value.push(...s),d.value=!1,k.value++}};E(()=>{window.onscroll=()=>{t.value===""&&scrollY+window.innerHeight>=document.body.scrollHeight-100&&x()},t.value===""&&x()});let z=null,C=v(()=>c.result);return U(t,s=>{clearTimeout(z),z=setTimeout(()=>{c.getSearch(s)},500)}),(s,p)=>{const T=V("router-link"),j=B("lazy");return o(),r("div",G,[u("div",J,[f(u("input",{type:"text",placeholder:"Найти фильм, сериал...","onUpdate:modelValue":p[0]||(p[0]=a=>K(t)?t.value=a:t=a)},null,512),[[I,g(t)]])]),g(C)?(o(),r("div",Q,[(o(!0),r(M,null,$(g(C),a=>(o(),h(Y,{key:a.id,item:a},null,8,["item"]))),128))])):b("",!0),m.value?(o(),r("div",W,[(o(!0),r(M,null,$(m.value,a=>(o(),h(T,{class:"main__catalog_list-item",to:"/movie/"+a.id,key:a.id},{default:D(()=>[f(u("img",X,null,512),[[j,y.value+S.value+a.backdrop_path]]),u("h2",null,N(a.title||a.name),1)]),_:2},1032,["to"]))),128))])):b("",!0)])}}},te={__name:"SearchPage",setup(l){return(e,c)=>(o(),r("div",null,[L(Z)]))}};export{te as default};
